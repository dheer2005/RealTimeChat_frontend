<div class="groups-container">
  <!-- Header -->
  <div class="header">
    <div class="header-content">
      <div class="brand-section">
        <svg xmlns="http://www.w3.org/2000/svg" class="brand-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
          <circle cx="9" cy="7" r="4"></circle>
          <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
          <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
        </svg>
        <div class="brand-text">
          <h2 class="brand-title">Groups</h2>
          <p class="brand-subtitle">Connect with multiple friends</p>
        </div>
      </div>
      <button class="create-group-btn" (click)="openCreateModal()">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="12" y1="5" x2="12" y2="19"></line>
          <line x1="5" y1="12" x2="19" y2="12"></line>
        </svg>
        New Group
      </button>
    </div>
  </div>

  <!-- Search Bar -->
  <div class="search-container">
    <svg class="search-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <circle cx="11" cy="11" r="8"></circle>
      <path d="m21 21-4.35-4.35"></path>
    </svg>
    <input 
      type="text" 
      placeholder="Search groups..." 
      [(ngModel)]="searchQuery"
      (input)="onSearch()"
      class="search-input"
    />
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loader-container">
    <div class="loader-spinner"></div>
    <p class="loader-text">Loading groups...</p>
  </div>

  <!-- Groups List -->
  <div *ngIf="!isLoading" class="groups-list">
    <div 
      *ngFor="let group of filteredGroups" 
      class="group-card"
      (click)="openGroup(group.id)"
    >
      <div class="group-avatar-container">
        <div class="group-avatar" *ngIf="!group.groupImage">
          {{ getGroupInitial(group.groupName) }}
        </div>
        <div class="group-avatar group-img-avatar" *ngIf="group.groupImage">
          <img [src]="group.groupImage" [alt]="group.groupName" />
        </div>
      </div>

      <div class="group-info">
        <div class="group-name-row">
          <span class="group-name">{{ group.groupName }}</span>
          <span class="member-count">{{ getMemberCount(group) }} members</span>
        </div>

        <div class="group-last-message">
            <div class="typing-text" *ngIf="group.typingText">
              {{ group.typingText }}
            </div>

            <span *ngIf="!group.typingUsers?.length" class="last-message">
                <span class="message-sender">{{ getLastMessageSender(group) }}</span>
                {{ getLastMessagePreview(group) }}
            </span>
        </div>
        
        <span *ngIf="group.unreadCount && group.unreadCount > 0"
            class="unread-badge">
        {{ group.unreadCount }}
        </span>
      </div>

      <div class="chevron-icon">
        <svg width="20" height="20" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M7 4l6 6-6 6"/>
        </svg>
      </div>
    </div>

    <!-- Empty State -->
    <div *ngIf="filteredGroups.length === 0 && !isLoading" class="empty-state">
      <svg class="empty-icon" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
        <circle cx="9" cy="7" r="4"></circle>
        <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
        <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
      </svg>
      <p class="empty-title">No groups found</p>
      <p class="empty-subtitle">Create a new group to get started!</p>
      <button class="create-group-btn-empty" (click)="openCreateModal()">
        Create Group
      </button>
    </div>
  </div>
</div>